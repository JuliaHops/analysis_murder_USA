# Анализ данных о случаях применения силы полицией в США (2015 год)  

---

## Основная часть  

### 1. Набор данных  
Датасет включает данные об убийствах полицией в США в 2015 году.  
Характеристики:  
- Формат: CSV  
- Количество признаков: 34  
- Количество записей: 468  

Примеры атрибутов:  
- name — имя умершего  
- age — возраст  
- gender — пол  
- raceethnicity — этническая принадлежность  
- month, day, year — дата происшествия  
- city, state — место происшествия  
- cause — причина смерти  
- armed — был ли вооружен  
- income, urate, college — социальные показатели района  

---

### 2. Архитектура конвейера для предобработки данных  
Для анализа использовались следующие инструменты:  

- MariaDB — база данных для хранения  
- Apache Hive — SQL-интерфейс для работы с данными в HDFS  
- Apache Sqoop — передача данных между реляционными БД и Hadoop  
- Apache Kafka — потоковая обработка  
- Apache Flume — управление потоками данных  

Этапы конвейера:  
1. Запуск служб HDFS и YARN
   
   <img width="1004" height="424" alt="image" src="https://github.com/user-attachments/assets/d9bcf32e-72b8-44bd-b0d6-21c3496ed131" />

3. Создание таблицы police_killings в MariaDB
   
   <img width="378" height="553" alt="image" src="https://github.com/user-attachments/assets/d93945ca-c127-43c7-b0a3-e08a91639956" />

5. Экспорт данных в MariaDB (через Sqoop)
   
   <img width="974" height="352" alt="image" src="https://github.com/user-attachments/assets/1d52497a-318a-4b70-96be-b8f459fafc19" />

7. Очистка и приведение типов данных
   
   <img width="641" height="367" alt="image" src="https://github.com/user-attachments/assets/c82ce0f4-c3c8-458e-b111-c3212a6a8543" />
 <img width="636" height="436" alt="image" src="https://github.com/user-attachments/assets/fee23320-a1ce-471c-8e3a-54d7b21cbd19" />

9. Перенос данных в Hive
    
    <img width="758" height="549" alt="image" src="https://github.com/user-attachments/assets/2619e7a5-707a-49ce-b14f-08736a50849f" />

11. Настройка потоковой передачи (Kafka + Flume)
    
    <img width="687" height="606" alt="image" src="https://github.com/user-attachments/assets/cab1b448-136e-4c09-9e71-66152de923b1" />
    <img width="588" height="513" alt="image" src="https://github.com/user-attachments/assets/fdffe380-463f-4f7a-a5a5-4059171ded91" />
<img width="774" height="849" alt="image" src="https://github.com/user-attachments/assets/68f858a7-85d8-449b-9026-e86d7bcc9f40" />

13. Организация регулярной выборки и записи данных в HDFS  

---

## Анализ данных  

### 2.1 География убийств  
- Наибольшее количество смертей: Калифорния, Техас, Флорида  
- Также высокий уровень: Аризона, Оклахома  
- Корреляция с населением, но важны и криминогенные факторы.  

### 2.2 Динамика по времени  
- Пик смертей: март–апрель  
- Минимум: июнь  
- Выражена сезонность.  

### 2.3 Возраст  
- Чаще всего жертвы: мужчины 25–37 лет  
- Женщины — в возрасте 30+  
- У мужчин разброс шире.  

### 2.4 Предпочтение оружия  
- Наиболее частая причина: огнестрельное оружие  
- У мужчин на 3 месте — ножи  
- У женщин на 3 месте — транспортные средства.  

### 2.5 Доход  
- Средний доход жертв: ниже среднего по США  
- Мужчины — $18–29 тыс.  
- Женщины — $21–34 тыс.  

### 2.6 Этническая принадлежность  
- Белые — 202 человек  
- Темнокожие — 118 человек  
- Латиноамериканцы — 59  
- Азиаты — 9  

По соотношению к населению:  
- Темнокожие: 0.19  
- Белые: 0.09  
- Латиноамериканцы: 0.06  
- Азиаты: 0.04  

---

## Выводы  

- Жертвами чаще становятся молодые мужчины (25–37 лет).  
- Самая уязвимая группа — темнокожие мужчины с низким доходом.  
- Наибольшая частота смертей наблюдается в крупных и криминогенных штатах.  
- Чаще всего причиной служит огнестрельное оружие.    
